<div class="container">
  <div class="row">
    <div class="col-md-12">
      <div>
        <h1>Suppliers</h1>
      </div>
      <div class="d-flex justify-content-between align-items-center">
        <form class="d-flex">
          <ocm-search class="mr-3 w-100"
                      [placeholderText]="'Search Suppliers...'"
                      [searchTermInput]="searchTermForSuppliers"
                      (searched)="searchSuppliers($event.detail)">
          </ocm-search>
        </form>
        <div class="d-flex align-items-center justify-content-start">
          <ng-template #filters>
            <div>
              <form class="d-flex flex-column"
                    [formGroup]="filterForm">
                <div class="group">
                  <select class="form-control input-sm"
                          type="select"
                          required
                          formControlName="serviceCategory">
                    <option *ngFor="let filter of serviceCategoryOptions"
                            value="{{filter}}">{{filter}}</option>
                  </select>
                  <span class="highlight"></span>
                  <label>Service Category</label>
                </div>
                <div class="group">
                  <select class="form-control input-sm"
                          type="select"
                          required
                          formControlName="vendorLevel">
                    <option *ngFor="let filter of vendorLevelOptions"
                            value="{{filter}}">{{filter}}</option>
                  </select>
                  <span class="highlight"></span>
                  <label>Vendor Level</label>
                </div>
              </form>
              <div class="d-flex justify-content-between align-items-center">
                <button (click)="cancelFilters()"
                        class="btn btn-sm btn-link text-dark">Cancel</button>
                <button (click)="applyFilters()"
                        class="btn btn-sm btn-primary">Apply</button>
              </div>
            </div>
          </ng-template>
          <div class="icon-button ripple"
               placement="bottom"
               [ngbPopover]="filters"
               [autoClose]="false"
               triggers="manual"
               #popover="ngbPopover"
               (click)="openPopover()"
               popoverTitle="Filter">
            <fa-layers class="fa-layers fa-fw">
              <fa-icon [icon]="faFilter">
              </fa-icon>
              <fa-layers-counter *ngIf="activeFilterCount && activeFilterCount > 0"
                                 class="badge__counter--large"
                                 style="background: gray"
                                 [content]="activeFilterCount">
              </fa-layers-counter>
            </fa-layers>
          </div>
          <ocm-supplier-sort [context]="context"
                             (closePopoverEvent)="closePopover($event.detail)">
          </ocm-supplier-sort>
          <div *ngIf="activeFilterCount > 0"
               class="icon-button ripple">
            <fa-icon [icon]="faTimes"
                     (click)="clearFilters()"></fa-icon>
          </div>
        </div>
      </div>
      <!--Loading Indicator-->
      <div *ngIf="!suppliers">
        <div class="d-flex flex-column">
          <div class="loading-box shine"></div>
          <div class="loading-box shine"></div>
          <div class="loading-box shine"></div>
          <div class="loading-box shine"></div>
        </div>
      </div>
      <div *ngIf="suppliers && suppliers.Items.length > 0">
        <div class="supplier-list"
             *ngFor="let supplier of suppliers.Items">
          <div class="supplier-card border-radius mb-4 p-3">
            <div class="d-flex justify-content-between align-items-center pb-3 border-bottom mb-3">
              <div class="d-flex justify-content-start align-items-center">
                <img *ngIf="supplier.xp.LogoUrl"
                     class="supplier-card--logo mr-4"
                     src="{{supplier.xp.LogoUrl}}"
                     alt="{{supplier.Name}} Logo" />
                <div class="d-flex flex-column mr-4">
                  <p class="h5 mb-0">{{supplier.Name}}</p>
                  <p class="small"><a href="{{supplier.xp.WebsiteURL}}"
                       target="_blank">{{supplier.xp.WebsiteURL}}</a></p>
                </div>
              </div>
              <button class="btn btn-sm btn-outline-dark shop-now"
                      (click)="shopSupplier(supplier)">Shop now!</button>
            </div>
            <div [innerHTML]="supplier.xp.Description"></div>
            <div class="d-flex justify-content-between align-items-start">
              <div class="d-flex flex-column mr-4">
                <p class="small text-muted mb-0">Links</p>
                <p class="small">No links available</p>
                <!-- *ngIf="supplier.xp.Links.length <= 0" -->
                <p *ngFor="let link of supplier.xp.Links"
                   class="small"><a href="{{link.URL}}"
                     target="_blank">{{link.DisplayName}}</a></p>
              </div>
              <div *ngIf="supplier.xp.Contacts"
                   class="d-flex flex-column text-right mr-4">
                <p class="small text-muted mb-0">Primary Contact</p>
                <p class="h6 mb-0">{{supplier.xp.Contacts[0].Name}}</p>
                <p class="mb-0">{{supplier.xp.Contacts[0].Email}}</p>
                <p>{{supplier.xp.Contacts[0].Phone}}</p>
              </div>
            </div>
          </div>
        </div>
        <ngb-pagination *ngIf="suppliers.Meta.TotalPages > 1"
                        maxSize="10"
                        class="d-flex justify-content-center"
                        [collectionSize]="suppliers.Meta.TotalCount"
                        [pageSize]="suppliers.Meta.PageSize"
                        [(page)]="suppliers.Meta.Page"
                        (pageChange)="changePage($event)"
                        [rotate]="true"
                        [boundaryLinks]="true">
        </ngb-pagination>
      </div>
    </div>
  </div>
</div>