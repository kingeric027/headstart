<div class="container-fluid mt-4"
     *ngIf="_product">
  <div class="row mb-5">
    <div class="col-xl-5 col-lg-5">
      <ocm-image-gallery [imgUrls]="imageUrls"></ocm-image-gallery>
    </div>
    <div class="col-xl-5 col-lg-4">
      <div class="pb-3 border-bottom border-medium">
        <small><a href="javascript:;"
             (click)="setActiveSupplier(_product?.xp.Facets?.supplier[0])">{{_product?.xp.Facets?.supplier[0]}}</a></small>
        <h1 class="h3 my-0">{{ _product.xp.Facets?.manufacturer[0]}} {{ _product.Name }}</h1>
        <ocm-toggle-favorite title="Favorite"
                             (click)="$event.stopPropagation()"
                             [favorite]="isFavorite()"
                             (favoriteChanged)="setIsFavorite($event.detail)">
        </ocm-toggle-favorite>
      </div>
      <div>
        <div>
          <div class="d-flex justify-content-between align-items-center">
            <h4 class="font-weight-bold">{{ price  | currency}}</h4>
            <p class="text-muted ml-3">1 per set</p> <!-- TODO: Plug in unit of measure when data is in OC. -->
            <span class="badge badge-pill badge-warning"
                  *ngIf="percentSavings > 0">You save {{ percentSavings }}%!
            </span>
          </div>
          <ocm-spec-form *ngIf="isOrderable && _specs.Items.length > 0"
                         [specs]="_specs"
                         (specFormChange)="onSpecFormChange($event)">
          </ocm-spec-form>
          <div *ngIf="!isOrderable"
               class="alert alert-info">
            This is a view-only product and cannot be ordered
          </div>
          <div class="d-flex flex-column"
               *ngIf="isOrderable">
            <div>Quantity: <br>
              <ocm-quantity-input class="d-inline-block mb-3"
                                  style="max-width: 200px"
                                  (qtyChange)="qtyChange($event.detail)"
                                  [product]="_product">
              </ocm-quantity-input>
            </div>

            <button class="btn btn-block btn-primary mb-3"
                    style="max-width: 200px"
                    type="submit"
                    [disabled]="!specFormService.event?.valid || !qtyValid"
                    (click)="addToCart($event)">
              Add to Cart
              <!-- <span class="badge badge-light ml-2">{{ price | currency }}</span> -->
            </button>
          </div>
        </div>
      </div>
      <div class="p-3 border border-medium border-radius"><strong>Description:</strong>
        <p [innerHTML]="_product.Description || 'This product has no description.'">
        </p>
      </div>
    </div>
  </div>
  <div *ngIf="relatedProducts$ | async; let relatedProducts">
    <ocm-product-carousel *ngIf="relatedProducts.length > 0"
                          displayTitle="Related Products"
                          [products]="relatedProducts">
    </ocm-product-carousel>
  </div>
</div>